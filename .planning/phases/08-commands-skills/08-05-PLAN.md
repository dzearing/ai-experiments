---
phase: 08-commands-skills
plan: 05
type: execute
wave: 3
depends_on: ["08-02"]
files_modified:
  - apps/claude-code-web/client/src/hooks/useKeyboardShortcuts.ts
  - apps/claude-code-web/client/src/components/ChatView.tsx
autonomous: true

must_haves:
  truths:
    - "Ctrl+L clears the conversation"
    - "Ctrl+C cancels current operation (interrupts streaming)"
    - "Shift+Tab cycles through permission modes"
    - "Keyboard shortcuts work globally within ChatView"
  artifacts:
    - path: "apps/claude-code-web/client/src/hooks/useKeyboardShortcuts.ts"
      provides: "Global keyboard shortcut handling"
      exports: ["useKeyboardShortcuts"]
    - path: "apps/claude-code-web/client/src/components/ChatView.tsx"
      provides: "ChatView with keyboard shortcuts"
      contains: "useKeyboardShortcuts"
  key_links:
    - from: "apps/claude-code-web/client/src/components/ChatView.tsx"
      to: "useKeyboardShortcuts"
      via: "hook usage"
      pattern: "useKeyboardShortcuts"
---

<objective>
Add keyboard shortcuts for Claude Code CLI parity including Ctrl+L (clear), Ctrl+C (cancel), and Shift+Tab (cycle modes).

Purpose: Enable power-user keyboard workflows matching Claude Code CLI experience.

Output: useKeyboardShortcuts hook with global shortcut handling wired into ChatView.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/08-commands-skills/08-RESEARCH.md
@.planning/phases/08-commands-skills/08-02-SUMMARY.md
@apps/claude-code-web/client/src/components/ChatView.tsx
@packages/ui-kit/react-chat/src/components/ChatInput/ChatInput.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useKeyboardShortcuts hook</name>
  <files>apps/claude-code-web/client/src/hooks/useKeyboardShortcuts.ts</files>
  <action>
Create hook for global keyboard shortcut handling.

Import useEffect, useCallback from react.

Define interface:
```typescript
interface UseKeyboardShortcutsOptions {
  onClear: () => void;
  onCancel: () => void;
  onCycleMode: () => void;
  enabled?: boolean;
}
```

Implement useKeyboardShortcuts hook:
1. useEffect to add/remove keydown listener on document
2. Handler function checks for:
   - Ctrl+L (or Cmd+L on Mac): preventDefault, call onClear
   - Ctrl+C (or Cmd+C on Mac): Only if not selecting text, call onCancel
   - Shift+Tab: Only if not in input/textarea focused, call onCycleMode

3. Check for text selection before Ctrl+C to avoid interfering with copy:
   ```typescript
   const selection = window.getSelection();
   const hasSelection = selection && selection.toString().length > 0;
   if ((e.ctrlKey || e.metaKey) && e.key === 'c' && !hasSelection) {
     e.preventDefault();
     onCancel();
   }
   ```

4. For Shift+Tab, check active element:
   ```typescript
   const activeTag = document.activeElement?.tagName?.toLowerCase();
   const isInInput = activeTag === 'input' || activeTag === 'textarea' ||
                     document.activeElement?.getAttribute('contenteditable') === 'true';
   if (e.shiftKey && e.key === 'Tab' && !isInInput) {
     e.preventDefault();
     onCycleMode();
   }
   ```

5. Cleanup listener on unmount

Return void (hook is purely side-effect based).
  </action>
  <verify>TypeScript compiles: `cd apps/claude-code-web/client && pnpm build`</verify>
  <done>useKeyboardShortcuts hook handles Ctrl+L, Ctrl+C, Shift+Tab</done>
</task>

<task type="auto">
  <name>Task 2: Wire keyboard shortcuts in ChatView</name>
  <files>apps/claude-code-web/client/src/components/ChatView.tsx</files>
  <action>
Import and use useKeyboardShortcuts in ChatView.

Import useKeyboardShortcuts from ../hooks/useKeyboardShortcuts.

Create cycleMode callback:
```typescript
const cycleMode = useCallback(() => {
  const modes: PermissionMode[] = ['default', 'plan', 'acceptEdits', 'bypassPermissions'];
  const currentIndex = modes.indexOf(permissionMode);
  const nextIndex = (currentIndex + 1) % modes.length;
  changePermissionMode(modes[nextIndex]);
}, [permissionMode, changePermissionMode]);
```

Call useKeyboardShortcuts:
```typescript
useKeyboardShortcuts({
  onClear: clearConversation,
  onCancel: interrupt,
  onCycleMode: cycleMode,
  enabled: true, // Could disable during dialogs
});
```

Note: clearConversation and interrupt come from useConversation.

Ensure interrupt is exposed from useConversation (it already is).
  </action>
  <verify>
Build passes: `cd apps/claude-code-web && pnpm build`
Manual test: Ctrl+L clears conversation
Manual test: Ctrl+C during streaming interrupts (when no text selected)
Manual test: Shift+Tab cycles mode when not in input
  </verify>
  <done>Keyboard shortcuts Ctrl+L, Ctrl+C, Shift+Tab work in ChatView</done>
</task>

<task type="auto">
  <name>Task 3: Document existing input shortcuts</name>
  <files>apps/claude-code-web/client/src/hooks/useKeyboardShortcuts.ts</files>
  <action>
Add comprehensive JSDoc documentation to useKeyboardShortcuts explaining all keyboard shortcuts.

Document in hook file header:
```typescript
/**
 * useKeyboardShortcuts - Global keyboard shortcuts for Claude Code Web
 *
 * Shortcuts handled by this hook (global):
 * - Ctrl+L / Cmd+L: Clear conversation
 * - Ctrl+C / Cmd+C: Cancel current operation (when no text selected)
 * - Shift+Tab: Cycle through permission modes
 *
 * Shortcuts handled by ChatInput (see react-chat):
 * - Enter: Submit message (single-line mode)
 * - Ctrl+Enter / Cmd+Enter: Submit message (multiline mode)
 * - Shift+Enter: Insert newline
 * - Up/Down: Navigate message history
 * - Escape+Escape: Clear input
 * - /: Show command palette
 * - Arrow keys: Navigate command palette
 * - Tab: Select command in palette
 *
 * Future (not yet implemented):
 * - Ctrl+R: Search message history
 * - @: File path mention
 */
```

This serves as documentation for the keyboard shortcut system.
  </action>
  <verify>TypeScript compiles</verify>
  <done>Keyboard shortcuts are documented in hook file</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors
2. Ctrl+L clears conversation from anywhere in ChatView
3. Ctrl+C cancels streaming (when not copying text)
4. Shift+Tab cycles through permission modes
5. Shortcuts don't interfere with normal text editing
</verification>

<success_criteria>
- Ctrl+L (Cmd+L on Mac) clears conversation
- Ctrl+C (Cmd+C on Mac) cancels streaming when no text selected
- Shift+Tab cycles permission modes when not in input
- Existing ChatInput shortcuts continue to work
- Shortcuts are documented
</success_criteria>

<output>
After completion, create `.planning/phases/08-commands-skills/08-05-SUMMARY.md`
</output>
