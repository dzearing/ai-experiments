---
phase: 06-extended-tools
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/claude-code-web/client/src/components/WebSearchResultDisplay.tsx
  - apps/claude-code-web/client/src/components/WebSearchResultDisplay.module.css
  - apps/claude-code-web/client/src/components/WebFetchResultDisplay.tsx
  - apps/claude-code-web/client/src/components/WebFetchResultDisplay.module.css
  - apps/claude-code-web/client/src/components/NotebookEditDisplay.tsx
  - apps/claude-code-web/client/src/components/NotebookEditDisplay.module.css
  - apps/claude-code-web/client/src/components/ToolResultDisplay.tsx
autonomous: true

must_haves:
  truths:
    - "WebSearch results display query and search results"
    - "WebFetch results show URL, prompt, and fetched content"
    - "NotebookEdit shows notebook path and cell changes"
    - "All web tools render content safely (no XSS)"
  artifacts:
    - path: "apps/claude-code-web/client/src/components/WebSearchResultDisplay.tsx"
      provides: "Search results visualization"
      exports: ["WebSearchResultDisplay"]
    - path: "apps/claude-code-web/client/src/components/WebFetchResultDisplay.tsx"
      provides: "Fetched web content display"
      exports: ["WebFetchResultDisplay"]
    - path: "apps/claude-code-web/client/src/components/NotebookEditDisplay.tsx"
      provides: "Notebook edit visualization"
      exports: ["NotebookEditDisplay"]
  key_links:
    - from: "ToolResultDisplay.tsx"
      to: "WebSearchResultDisplay.tsx"
      via: "switch case for 'WebSearch' tool"
      pattern: "case 'WebSearch'"
    - from: "ToolResultDisplay.tsx"
      to: "WebFetchResultDisplay.tsx"
      via: "switch case for 'WebFetch' tool"
      pattern: "case 'WebFetch'"
    - from: "ToolResultDisplay.tsx"
      to: "NotebookEditDisplay.tsx"
      via: "switch case for 'NotebookEdit' tool"
      pattern: "case 'NotebookEdit'"
---

<objective>
Web tools and notebook editing visualization

Purpose: Users need to see web search results, fetched content, and notebook modifications. Web content must be displayed safely without XSS risk.

Output: WebSearchResultDisplay, WebFetchResultDisplay, and NotebookEditDisplay components integrated into ToolResultDisplay router.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-extended-tools/06-RESEARCH.md

@apps/claude-code-web/client/src/components/ToolResultDisplay.tsx
@apps/claude-code-web/client/src/components/SearchResultsDisplay.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create WebSearchResultDisplay component</name>
  <files>
    apps/claude-code-web/client/src/components/WebSearchResultDisplay.tsx
    apps/claude-code-web/client/src/components/WebSearchResultDisplay.module.css
  </files>
  <action>
1. Create WebSearchResultDisplay.tsx:
   - Props interface:
     ```typescript
     interface WebSearchResultDisplayProps {
       query: string;
       output: string;  // SDK returns search results as text
       allowedDomains?: string[];
       blockedDomains?: string[];
       isExpanded: boolean;
       onToggleExpand: () => void;
     }
     ```
   - Header shows search query with search icon
   - If allowed/blocked domains specified, show filter info
   - Output is the search results text from SDK - display in expandable section
   - SDK processes web content through AI, so output is safe markdown/text
   - Consider parsing output to extract URLs and make them clickable links

2. Create WebSearchResultDisplay.module.css:
   - Search header styling with query emphasis
   - Results list styling
   - External link styling (indicate links open in new tab)
   - Use design tokens: --color-body-link, --spacing-*, etc.

Note: SDK returns pre-processed safe content, so no XSS concern for the text output.
  </action>
  <verify>
    - File exists at apps/claude-code-web/client/src/components/WebSearchResultDisplay.tsx
    - TypeScript compiles: `cd apps/claude-code-web/client && pnpm tsc --noEmit`
  </verify>
  <done>
    WebSearchResultDisplay shows search query and results with expandable content
  </done>
</task>

<task type="auto">
  <name>Task 2: Create WebFetchResultDisplay and NotebookEditDisplay components</name>
  <files>
    apps/claude-code-web/client/src/components/WebFetchResultDisplay.tsx
    apps/claude-code-web/client/src/components/WebFetchResultDisplay.module.css
    apps/claude-code-web/client/src/components/NotebookEditDisplay.tsx
    apps/claude-code-web/client/src/components/NotebookEditDisplay.module.css
  </files>
  <action>
1. Create WebFetchResultDisplay.tsx:
   - Props interface:
     ```typescript
     interface WebFetchResultDisplayProps {
       url: string;
       prompt: string;
       output: string;  // AI-processed content (safe markdown)
       isExpanded: boolean;
       onToggleExpand: () => void;
     }
     ```
   - Header shows URL as external link (opens in new tab)
   - Show the prompt used to extract content
   - Content display: SDK returns AI-processed markdown, render as text
   - Could use MarkdownRenderer if available, or just pre-formatted text for safety
   - Expandable content section

2. Create WebFetchResultDisplay.module.css:
   - URL header with external link indicator
   - Prompt display (subtle, like a label)
   - Content area styling

3. Create NotebookEditDisplay.tsx:
   - Props interface:
     ```typescript
     interface NotebookEditDisplayProps {
       notebookPath: string;
       cellId?: string;
       cellType?: 'code' | 'markdown';
       editMode?: 'replace' | 'insert' | 'delete';
       newSource: string;
       output: string;
       isExpanded: boolean;
       onToggleExpand: () => void;
       onFileClick?: (path: string) => void;
     }
     ```
   - Header shows notebook path (clickable via ClickablePath)
   - Show cell ID and operation type (e.g., "Replaced cell abc123")
   - When expanded, show the new cell content with appropriate syntax highlighting
     - If cellType='code', use 'python' highlighting (most common for notebooks)
     - If cellType='markdown', show as markdown text
   - Use CodeBlock or similar for content display

4. Create NotebookEditDisplay.module.css:
   - Notebook icon/styling
   - Cell info display
   - Content area with appropriate styling based on cell type
  </action>
  <verify>
    - Files exist at specified paths
    - TypeScript compiles: `cd apps/claude-code-web/client && pnpm tsc --noEmit`
  </verify>
  <done>
    WebFetchResultDisplay shows URL, prompt, and content; NotebookEditDisplay shows notebook path, cell info, and cell content
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate web tools and notebook into ToolResultDisplay</name>
  <files>
    apps/claude-code-web/client/src/components/ToolResultDisplay.tsx
  </files>
  <action>
1. Import all three new components in ToolResultDisplay.tsx

2. Add case 'WebSearch':
   - Extract: query, allowed_domains, blocked_domains from input
   - Render WebSearchResultDisplay

3. Add case 'WebFetch':
   - Extract: url, prompt from input
   - Render WebFetchResultDisplay

4. Add case 'NotebookEdit':
   - Extract: notebook_path, cell_id, cell_type, edit_mode, new_source from input
   - Render NotebookEditDisplay

5. Run build and lint to verify integration:
   ```bash
   cd apps/claude-code-web/client && pnpm build && pnpm lint
   ```
  </action>
  <verify>
    - Build passes: `cd apps/claude-code-web/client && pnpm build`
    - Lint passes: `cd apps/claude-code-web/client && pnpm lint`
    - ToolResultDisplay switch has cases for WebSearch, WebFetch, NotebookEdit
  </verify>
  <done>
    All three web/notebook tools route to their respective display components in ToolResultDisplay
  </done>
</task>

</tasks>

<verification>
1. Build passes: `cd apps/claude-code-web/client && pnpm build`
2. Lint passes: `cd apps/claude-code-web/client && pnpm lint`
3. WebSearch tool renders WebSearchResultDisplay
4. WebFetch tool renders WebFetchResultDisplay
5. NotebookEdit tool renders NotebookEditDisplay
6. All content displays safely (SDK pre-processes web content)
</verification>

<success_criteria>
- WebSearch results show query and search results
- WebFetch results show URL, prompt, and AI-processed content
- NotebookEdit shows notebook path, cell info, and cell content with syntax highlighting
- All tools integrate into ToolResultDisplay router
- Build and lint pass
</success_criteria>

<output>
After completion, create `.planning/phases/06-extended-tools/06-03-SUMMARY.md`
</output>
