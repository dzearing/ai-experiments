---
phase: 04-hover-toolbar
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - react-chat/src/components/MessageToolbar/MessageToolbar.tsx
  - react-chat/src/components/MessageToolbar/MessageToolbar.module.css
  - react-chat/src/components/MessageToolbar/index.ts
autonomous: true

must_haves:
  truths:
    - "MessageToolbar component renders timestamp and action buttons"
    - "Toolbar has backdrop blur visual effect"
    - "Toolbar styling adapts for user vs assistant messages"
  artifacts:
    - path: "react-chat/src/components/MessageToolbar/MessageToolbar.tsx"
      provides: "MessageToolbar component with timestamp, copy, edit buttons"
      exports: ["MessageToolbar", "MessageToolbarProps"]
    - path: "react-chat/src/components/MessageToolbar/MessageToolbar.module.css"
      provides: "Toolbar positioning, backdrop blur, user/assistant variants"
      contains: "backdrop-filter"
    - path: "react-chat/src/components/MessageToolbar/index.ts"
      provides: "Barrel export"
      exports: ["MessageToolbar", "MessageToolbarProps"]
  key_links:
    - from: "MessageToolbar.tsx"
      to: "@ui-kit/react CopyButton"
      via: "import and composition"
      pattern: "import.*CopyButton.*from.*@ui-kit/react"
    - from: "MessageToolbar.tsx"
      to: "@ui-kit/react IconButton"
      via: "import and composition"
      pattern: "import.*IconButton.*from.*@ui-kit/react"
---

<objective>
Create the MessageToolbar component for displaying message actions on hover

Purpose: Provides a reusable toolbar component that displays timestamp, copy button, and optional edit button. This component will be integrated into ChatMessage in Plan 02.

Output: MessageToolbar component with CSS module, ready for integration
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-hover-toolbar/04-RESEARCH.md

# Prior phase context - group mode structure this toolbar will integrate with
@.planning/phases/03-group-mode/03-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MessageToolbar component and CSS module</name>
  <files>
    react-chat/src/components/MessageToolbar/MessageToolbar.tsx
    react-chat/src/components/MessageToolbar/MessageToolbar.module.css
    react-chat/src/components/MessageToolbar/index.ts
  </files>
  <action>
Create the MessageToolbar component directory and files:

**MessageToolbar.tsx:**
```typescript
interface MessageToolbarProps {
  /** Message timestamp for display */
  timestamp: Date | number | string;
  /** Callback to get message content for copy (async supported) */
  getContent: () => string | Promise<string>;
  /** Whether this is the user's own message (affects styling) */
  isOwn?: boolean;
  /** Show edit button (default: false) */
  showEdit?: boolean;
  /** Callback when edit is clicked */
  onEdit?: () => void;
  /** Additional CSS class */
  className?: string;
}
```

Implementation details:
1. Import CopyButton and IconButton from @ui-kit/react
2. Import EditIcon from @ui-kit/icons/EditIcon
3. Create formatTime helper using toLocaleTimeString with hour/minute format
4. Render structure: timestamp span + CopyButton (size="sm", variant="ghost") + optional IconButton for edit
5. Apply isOwn conditional class for user vs assistant styling
6. Use CSS modules for styling

**MessageToolbar.module.css:**
Follow the mockup pattern from research (lines 172-246 of shared/styles.module.css):
- Position: absolute, right/top with --space-2 offset
- Flex layout with 2px gap, padding 2px (padding-left --space-2 for timestamp)
- Border-radius: --radius-full (pill shape)
- Opacity 0 by default (parent hover will reveal)
- backdrop-filter: blur(8px)
- Two variants: toolbarUser (--primary-bg-hover bg) and toolbarOther (--soft-bg with border)
- Timestamp styling: --text-xs, different colors for user (--primary-fg) vs other (--base-fg-soft)
- Button styling via existing ui-kit components (no custom button styles needed)

**index.ts:**
Export MessageToolbar and MessageToolbarProps
  </action>
  <verify>
- File exists: react-chat/src/components/MessageToolbar/MessageToolbar.tsx
- File exists: react-chat/src/components/MessageToolbar/MessageToolbar.module.css
- File exists: react-chat/src/components/MessageToolbar/index.ts
- Run: cd /Users/dzearing/git/ai-exp-2/packages/ui-kit && pnpm build
- Build passes without errors
  </verify>
  <done>
MessageToolbar component created with:
- Props: timestamp, getContent, isOwn, showEdit, onEdit, className
- Renders: formatted time, CopyButton, optional edit IconButton
- CSS: backdrop blur, user/assistant variants, positioned absolute
- TypeScript compiles without errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Export MessageToolbar from react-chat package</name>
  <files>
    react-chat/src/index.ts
  </files>
  <action>
Add MessageToolbar export to the react-chat package index:

1. Add import: export { MessageToolbar, type MessageToolbarProps } from './components/MessageToolbar';
2. Place after existing component exports (ChatMessage, ChatLayout, etc.)
  </action>
  <verify>
- Run: cd /Users/dzearing/git/ai-exp-2/packages/ui-kit && pnpm build
- Build passes
- Check react-chat/dist/index.d.ts contains MessageToolbar export
  </verify>
  <done>
MessageToolbar exported from @ui-kit/react-chat package, available for consumers
  </done>
</task>

</tasks>

<verification>
1. Build passes: `cd /Users/dzearing/git/ai-exp-2/packages/ui-kit && pnpm build`
2. MessageToolbar component exists with correct props interface
3. CSS includes backdrop-filter and user/assistant variants
4. Package exports MessageToolbar
</verification>

<success_criteria>
- MessageToolbar component created with timestamp, copy button, optional edit button
- Toolbar has backdrop blur (backdrop-filter: blur(8px))
- Two visual variants: user (primary-bg-hover) and assistant (soft-bg with border)
- Component exported from react-chat package
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-hover-toolbar/04-01-SUMMARY.md`
</output>
