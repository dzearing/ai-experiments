{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "version": "1.0.0",
  "description": "UI Kit Theme Generation Rules - Defines all token roles, derivation rules, and color logic",

  "semanticColors": {
    "description": "Fixed semantic colors that remain consistent across all themes for UX clarity",
    "success": {
      "base": "#16a34a",
      "description": "Positive outcomes, confirmations, completion states"
    },
    "warning": {
      "base": "#f59e0b",
      "description": "Caution states, attention needed, pending actions"
    },
    "danger": {
      "base": "#dc2626",
      "description": "Errors, destructive actions, critical states"
    },
    "info": {
      "base": "#0ea5e9",
      "description": "Informational, neutral status, help content"
    }
  },

  "roles": {
    "container": {
      "description": "Token roles for static background regions",
      "types": {
        "page": {
          "description": "Main application background",
          "tokens": ["bg", "text", "text-soft", "text-softer", "text-strong", "text-stronger", "border", "border-soft", "border-strong", "border-stronger", "shadow"],
          "defaults": {
            "light": { "bg": "#fafafa", "text": "#171717" },
            "dark": { "bg": "#0f0f0f", "text": "#e5e5e5" }
          },
          "derivation": {
            "border": { "light": "darken(page.bg, 8)", "dark": "lighten(page.bg, 20)" }
          }
        },
        "card": {
          "description": "Elevated content containers - raised from page",
          "tokens": ["bg", "text", "text-soft", "text-strong", "text-stronger", "border", "border-soft", "border-strong", "border-stronger", "shadow"],
          "derivation": {
            "bg": { "light": "lighten(page.bg, 8)", "dark": "lighten(page.bg, 8)" },
            "text": "inherit:page.text",
            "border": "inherit:page.border",
            "shadow": { "light": "0 4px 6px -1px rgba(0, 0, 0, 0.1)", "dark": "0 4px 6px -1px rgba(0, 0, 0, 0.4)" }
          }
        },
        "overlay": {
          "description": "Modals, dialogs, sheets - higher elevation than card",
          "tokens": ["bg", "text", "text-soft", "text-strong", "text-stronger", "border", "border-soft", "border-strong", "border-stronger", "shadow"],
          "derivation": {
            "bg": { "light": "lighten(page.bg, 10)", "dark": "lighten(page.bg, 12)" },
            "border": "inherit:page.border",
            "shadow": { "light": "0 0 0 1px rgba(0, 0, 0, 0.08), 0 4px 16px rgba(0, 0, 0, 0.12), 0 16px 32px -4px rgba(0, 0, 0, 0.14)", "dark": "0 0 0 1px rgba(255, 255, 255, 0.1), 0 4px 16px rgba(0, 0, 0, 0.4), 0 16px 32px -4px rgba(0, 0, 0, 0.5)" }
          }
        },
        "popout": {
          "description": "Dropdowns, menus, tooltips (highest elevation)",
          "tokens": ["bg", "text", "text-soft", "text-strong", "text-stronger", "border", "border-soft", "border-strong", "border-stronger", "shadow"],
          "derivation": {
            "bg": { "light": "lighten(page.bg, 12)", "dark": "lighten(page.bg, 16)" },
            "border": "inherit:page.border",
            "shadow": { "light": "0 10px 15px -3px rgba(0, 0, 0, 0.1)", "dark": "0 10px 15px -3px rgba(0, 0, 0, 0.5)" }
          }
        },
        "inset": {
          "description": "Recessed areas (input fields, wells) - sunken from page",
          "tokens": ["bg", "bg-hover", "bg-focus", "text", "text-soft", "border", "border-focus"],
          "derivation": {
            "bg": { "light": "darken(page.bg, 4)", "dark": "darken(page.bg, 4)" },
            "bg-hover": { "light": "darken(page.bg, 6)", "dark": "lighten(page.bg, 4)" },
            "bg-focus": { "light": "lighten(page.bg, 4)", "dark": "lighten(page.bg, 6)" },
            "border": "inherit:page.border",
            "border-focus": "theme:primary"
          }
        }
      }
    },
    "control": {
      "description": "Token roles for interactive elements",
      "types": {
        "control": {
          "description": "Default interactive (buttons, list items)",
          "tokens": ["bg", "bg-hover", "bg-pressed", "text", "text-hover", "text-pressed", "border", "border-hover", "border-pressed", "shadow"],
          "defaults": {
            "light": { "bg": "#f0f0f0", "bg-hover": "#e5e5e5", "bg-pressed": "#d4d4d4", "border": "#e0e0e0", "border-hover": "#d4d4d4", "border-pressed": "#c4c4c4" },
            "dark": { "bg": "#2a2a2a", "bg-hover": "#333333", "bg-pressed": "#404040", "border": "#3a3a3a", "border-hover": "#444444", "border-pressed": "#4d4d4d" }
          }
        },
        "controlPrimary": {
          "description": "Primary actions (CTA buttons, selected states)",
          "tokens": ["bg", "bg-hover", "bg-pressed", "text", "border", "shadow"],
          "derivation": {
            "bg": "theme:primary",
            "bg-hover": { "light": "darken(theme:primary, 8)", "dark": "lighten(theme:primary, 8)" },
            "bg-pressed": { "light": "darken(theme:primary, 12)", "dark": "lighten(theme:primary, 12)" },
            "text": "contrast(bg)",
            "border": "transparent"
          }
        },
        "controlDanger": {
          "description": "Destructive actions",
          "tokens": ["bg", "bg-hover", "bg-pressed", "text", "border", "shadow"],
          "derivation": {
            "bg": "semantic:danger",
            "bg-hover": { "light": "darken(semantic:danger, 8)", "dark": "lighten(semantic:danger, 8)" },
            "bg-pressed": { "light": "darken(semantic:danger, 12)", "dark": "lighten(semantic:danger, 12)" },
            "text": "contrast(bg)",
            "border": "transparent"
          }
        },
        "controlSubtle": {
          "description": "Ghost/minimal buttons, tabs",
          "tokens": ["bg", "bg-hover", "bg-pressed", "text", "text-hover", "text-pressed", "border"],
          "defaults": {
            "light": {
              "bg": "transparent",
              "bg-hover": "rgba(0, 0, 0, 0.04)",
              "bg-pressed": "rgba(0, 0, 0, 0.08)"
            },
            "dark": {
              "bg": "transparent",
              "bg-hover": "rgba(255, 255, 255, 0.08)",
              "bg-pressed": "rgba(255, 255, 255, 0.12)"
            }
          },
          "derivation": {
            "text": "mix(page.text, page.bg, 0.2)",
            "text-hover": "page.text",
            "text-pressed": "page.text",
            "border": "transparent"
          }
        },
        "controlDisabled": {
          "description": "Non-interactive state",
          "tokens": ["bg", "text", "border"],
          "defaults": {
            "light": { "bg": "#f5f5f5", "text": "#a3a3a3", "border": "#e5e5e5" },
            "dark": { "bg": "#1f1f1f", "text": "#525252", "border": "#2a2a2a" }
          }
        }
      }
    },
    "feedback": {
      "description": "Token roles for status communication",
      "types": {
        "success": {
          "tokens": ["bg", "text", "text-soft", "border", "icon"],
          "derivation": {
            "bg": { "light": "mix(semantic:success, #ffffff, 0.9)", "dark": "mix(semantic:success, #000000, 0.85)" },
            "text": { "light": "darken(semantic:success, 30)", "dark": "lighten(semantic:success, 30)" },
            "text-soft": "mix(text, bg, 0.3)",
            "border": { "light": "darken(semantic:success, 10)", "dark": "lighten(semantic:success, 20)" },
            "icon": "semantic:success"
          }
        },
        "warning": {
          "tokens": ["bg", "text", "text-soft", "border", "icon"],
          "derivation": {
            "bg": { "light": "mix(semantic:warning, #ffffff, 0.9)", "dark": "mix(semantic:warning, #000000, 0.85)" },
            "text": { "light": "darken(semantic:warning, 30)", "dark": "lighten(semantic:warning, 30)" },
            "text-soft": "mix(text, bg, 0.3)",
            "border": { "light": "darken(semantic:warning, 10)", "dark": "lighten(semantic:warning, 20)" },
            "icon": "semantic:warning"
          }
        },
        "danger": {
          "tokens": ["bg", "text", "text-soft", "border", "icon"],
          "derivation": {
            "bg": { "light": "mix(semantic:danger, #ffffff, 0.9)", "dark": "mix(semantic:danger, #000000, 0.85)" },
            "text": { "light": "darken(semantic:danger, 30)", "dark": "lighten(semantic:danger, 30)" },
            "text-soft": "mix(text, bg, 0.3)",
            "border": { "light": "darken(semantic:danger, 10)", "dark": "lighten(semantic:danger, 20)" },
            "icon": "semantic:danger"
          }
        },
        "info": {
          "tokens": ["bg", "text", "text-soft", "border", "icon"],
          "derivation": {
            "bg": { "light": "mix(semantic:info, #ffffff, 0.9)", "dark": "mix(semantic:info, #000000, 0.85)" },
            "text": { "light": "darken(semantic:info, 30)", "dark": "lighten(semantic:info, 30)" },
            "text-soft": "mix(text, bg, 0.3)",
            "border": { "light": "darken(semantic:info, 10)", "dark": "lighten(semantic:info, 20)" },
            "icon": "semantic:info"
          }
        }
      }
    }
  },

  "specialTokens": {
    "focus": {
      "description": "Focus ring for accessibility",
      "tokens": {
        "ring": { "derivation": "theme:primary" },
        "ring-offset": { "default": "2px" },
        "ring-width": { "default": "2px" }
      }
    },
    "selection": {
      "description": "Text selection highlight",
      "tokens": {
        "bg": { "derivation": { "light": "mix(theme:primary, #ffffff, 0.7)", "dark": "mix(theme:primary, #000000, 0.7)" } },
        "text": { "default": { "light": "#000000", "dark": "#ffffff" } }
      }
    },
    "link": {
      "description": "Hyperlink colors",
      "tokens": {
        "default": { "derivation": "theme:primary" },
        "hover": { "derivation": { "light": "darken(theme:primary, 10)", "dark": "lighten(theme:primary, 10)" } },
        "pressed": { "derivation": { "light": "darken(theme:primary, 15)", "dark": "lighten(theme:primary, 15)" } },
        "visited": { "derivation": "mix(theme:primary, #8b5cf6, 0.5)" }
      }
    },
    "scrollbar": {
      "description": "Custom scrollbar styling",
      "tokens": {
        "track": { "default": { "light": "#f5f5f5", "dark": "#1a1a1a" } },
        "thumb": { "default": { "light": "#c4c4c4", "dark": "#404040" } },
        "thumb-hover": { "default": { "light": "#a3a3a3", "dark": "#525252" } }
      }
    },
    "skeleton": {
      "description": "Loading skeleton states",
      "tokens": {
        "bg": { "default": { "light": "#e5e5e5", "dark": "#333333" } },
        "shimmer": { "default": { "light": "rgba(255, 255, 255, 0.5)", "dark": "rgba(255, 255, 255, 0.1)" } }
      }
    },
    "highlight": {
      "description": "Search/text highlight",
      "tokens": {
        "bg": { "derivation": { "light": "mix(theme:primary, #ffffff, 0.8)", "dark": "mix(theme:primary, #000000, 0.8)" } },
        "text": { "default": { "light": "#000000", "dark": "#ffffff" } }
      }
    }
  },

  "componentTokens": {
    "description": "Shortcut tokens for common component patterns",
    "tokens": {
      "button-padding-x": { "default": "var(--space-4)" },
      "button-padding-y": { "default": "var(--space-2)" },
      "button-radius": { "default": "var(--radius-md)" },
      "input-height": { "default": "40px" },
      "input-padding-x": { "default": "var(--space-3)" },
      "card-padding": { "default": "var(--space-4)" },
      "modal-padding": { "default": "var(--space-6)" },
      "avatar-size-sm": { "default": "24px" },
      "avatar-size-md": { "default": "32px" },
      "avatar-size-lg": { "default": "48px" }
    }
  },

  "colorDerivation": {
    "description": "Rules for deriving colors from theme inputs",
    "rules": {
      "text-soft": {
        "formula": "mix(text, bg, 0.3)",
        "description": "30% less contrast than base text"
      },
      "text-softer": {
        "formula": "mix(text, bg, 0.5)",
        "description": "50% less contrast than base text"
      },
      "text-strong": {
        "formula": "mix(text, contrast(bg), 0.3)",
        "description": "Higher contrast text (30% toward maximum)"
      },
      "text-stronger": {
        "formula": { "light": "#000000", "dark": "#ffffff" },
        "description": "Maximum contrast text"
      },
      "border-soft": {
        "formula": { "light": "mix(page.border, page.bg, 0.4)", "dark": "mix(page.border, page.bg, 0.4)" },
        "description": "Subtle border - less contrast than default"
      },
      "border-strong": {
        "formula": { "light": "darken(page.border, 20)", "dark": "lighten(page.border, 20)" },
        "description": "Higher contrast border"
      },
      "border-stronger": {
        "formula": { "light": "mix(page.border, #000000, 0.5)", "dark": "mix(page.border, #ffffff, 0.5)" },
        "description": "Maximum contrast border"
      },
      "border-default": {
        "formula": { "light": "#e5e5e5", "dark": "#333333" },
        "description": "Subtle border color"
      },
      "secondary-from-primary": {
        "formula": "shiftHue(primary, 15)",
        "description": "Secondary derived by shifting primary hue 15 degrees"
      },
      "accent-from-primary": {
        "formula": "shiftHue(primary, 180)",
        "description": "Accent as complementary color to primary"
      },
      "neutral-from-primary": {
        "formula": "desaturate(primary, 80)",
        "description": "Neutral derived by desaturating primary"
      }
    }
  },

  "surfaces": {
    "description": "Tonal surface definitions - CSS classes that reset and override tokens for different visual contexts",
    "pattern": {
      "description": "Every .surface element resets ALL tokens to page defaults, then applies variant overrides. Nested surfaces reset automatically.",
      "baseClass": ".surface",
      "modifierClasses": ".surface.{variant}"
    },
    "types": {
      "base": {
        "description": "Explicit reset to page defaults",
        "overrides": {}
      },
      "raised": {
        "description": "Elevated content (cards, panels) - lighter/elevated from page",
        "overrides": {
          "light": {
            "surface-bg": "#ffffff",
            "surface-border": "#e5e5e5",
            "surface-shadow": "0 4px 6px -1px rgba(0, 0, 0, 0.1)"
          },
          "dark": {
            "surface-bg": "#1a1a1a",
            "surface-border": "#333333",
            "surface-shadow": "0 4px 6px -1px rgba(0, 0, 0, 0.4)"
          }
        }
      },
      "sunken": {
        "description": "Recessed areas (input wells, sidebars) - darker/recessed from page",
        "overrides": {
          "light": {
            "surface-bg": "#f0f0f0",
            "surface-border": "#e5e5e5",
            "control-bg": "#e5e5e5",
            "control-bg-hover": "#d9d9d9",
            "control-bg-pressed": "#cccccc"
          },
          "dark": {
            "surface-bg": "#0a0a0a",
            "surface-border": "#262626",
            "control-bg": "#1f1f1f",
            "control-bg-hover": "#2a2a2a",
            "control-bg-pressed": "#333333"
          }
        }
      },
      "soft": {
        "description": "Subtle backgrounds - slightly muted from page",
        "overrides": {
          "light": {
            "surface-bg": "#f7f7f7"
          },
          "dark": {
            "surface-bg": "#141414"
          }
        }
      },
      "softer": {
        "description": "Very subtle backgrounds - more muted from page",
        "overrides": {
          "light": {
            "surface-bg": "#f3f3f3"
          },
          "dark": {
            "surface-bg": "#1a1a1a"
          }
        }
      },
      "strong": {
        "description": "Emphasized sections - higher contrast from page",
        "overrides": {
          "light": {
            "surface-bg": "#e5e5e5",
            "control-bg": "#d9d9d9",
            "control-bg-hover": "#cccccc",
            "control-bg-pressed": "#bfbfbf"
          },
          "dark": {
            "surface-bg": "#262626",
            "control-bg": "#333333",
            "control-bg-hover": "#404040",
            "control-bg-pressed": "#4d4d4d"
          }
        }
      },
      "stronger": {
        "description": "Very emphasized sections - highest contrast from page",
        "overrides": {
          "light": {
            "surface-bg": "#d4d4d4",
            "control-bg": "#c4c4c4",
            "control-bg-hover": "#b3b3b3",
            "control-bg-pressed": "#a3a3a3"
          },
          "dark": {
            "surface-bg": "#333333",
            "control-bg": "#404040",
            "control-bg-hover": "#4d4d4d",
            "control-bg-pressed": "#5a5a5a"
          }
        }
      },
      "inverted": {
        "description": "Opposite color scheme (tooltips, callouts)",
        "overrides": {
          "light": {
            "surface-bg": "#1a1a1a",
            "surface-text": "#e5e5e5",
            "surface-text-soft": "#a3a3a3",
            "surface-text-softer": "#737373",
            "surface-text-strong": "#f0f0f0",
            "surface-text-stronger": "#ffffff",
            "surface-border": "#333333",
            "surface-border-soft": "#262626",
            "surface-border-strong": "#4d4d4d",
            "surface-border-stronger": "#666666",
            "control-bg": "#333333",
            "control-bg-hover": "#404040",
            "control-bg-pressed": "#4d4d4d",
            "control-text": "#e5e5e5",
            "controlSubtle-text": "#a3a3a3",
            "controlSubtle-text-hover": "#e5e5e5",
            "controlSubtle-bg-hover": "rgba(255, 255, 255, 0.08)",
            "controlSubtle-bg-pressed": "rgba(255, 255, 255, 0.12)"
          },
          "dark": {
            "surface-bg": "#fafafa",
            "surface-text": "#171717",
            "surface-text-soft": "#5b5b5b",
            "surface-text-softer": "#898989",
            "surface-text-strong": "#0f0f0f",
            "surface-text-stronger": "#000000",
            "surface-border": "#e5e5e5",
            "surface-border-soft": "#f0f0f0",
            "surface-border-strong": "#c4c4c4",
            "surface-border-stronger": "#999999",
            "control-bg": "#e5e5e5",
            "control-bg-hover": "#d9d9d9",
            "control-bg-pressed": "#cccccc",
            "control-text": "#171717",
            "controlSubtle-text": "#5b5b5b",
            "controlSubtle-text-hover": "#171717",
            "controlSubtle-bg-hover": "rgba(0, 0, 0, 0.04)",
            "controlSubtle-bg-pressed": "rgba(0, 0, 0, 0.08)"
          }
        }
      },
      "primary": {
        "description": "Primary color background (teaching bubbles, branded sections)",
        "note": "Uses controlPrimary tokens for consistency with theme primary color",
        "overrides": {
          "light": {
            "surface-bg": "var(--controlPrimary-bg)",
            "surface-text": "var(--controlPrimary-text)",
            "surface-border": "var(--controlPrimary-bg-hover)",
            "control-bg": "var(--controlPrimary-bg-hover)",
            "control-bg-hover": "var(--controlPrimary-bg-pressed)",
            "control-bg-pressed": "var(--controlPrimary-bg-pressed)",
            "control-text": "var(--controlPrimary-text)",
            "controlSubtle-text": "var(--controlPrimary-text)",
            "controlSubtle-bg-hover": "rgba(255, 255, 255, 0.2)",
            "controlSubtle-bg-pressed": "rgba(255, 255, 255, 0.3)"
          },
          "dark": {
            "surface-bg": "var(--controlPrimary-bg)",
            "surface-text": "var(--controlPrimary-text)",
            "surface-border": "var(--controlPrimary-bg-hover)",
            "control-bg": "var(--controlPrimary-bg-hover)",
            "control-bg-hover": "var(--controlPrimary-bg-pressed)",
            "control-bg-pressed": "var(--controlPrimary-bg-pressed)",
            "control-text": "var(--controlPrimary-text)",
            "controlSubtle-text": "var(--controlPrimary-text)",
            "controlSubtle-bg-hover": "rgba(0, 0, 0, 0.2)",
            "controlSubtle-bg-pressed": "rgba(0, 0, 0, 0.3)"
          }
        }
      }
    },
    "feedbackSurfaces": {
      "description": "Feedback surfaces use the existing feedback role tokens",
      "note": "success, warning, danger, info surfaces apply their role tokens as surface overrides"
    }
  },

  "accessibility": {
    "contrastRequirements": {
      "AA": {
        "normalText": 4.5,
        "largeText": 3,
        "uiComponents": 3
      },
      "AAA": {
        "normalText": 7,
        "largeText": 4.5,
        "uiComponents": 4.5
      }
    }
  },

  "themeInputSchema": {
    "description": "Schema for theme JSON files",
    "required": ["id", "name", "colors"],
    "properties": {
      "id": { "type": "string", "pattern": "^[a-z][a-z0-9-]*$" },
      "name": { "type": "string" },
      "description": { "type": "string" },
      "colors": {
        "required": ["primary"],
        "properties": {
          "primary": { "type": "string", "format": "color" },
          "secondary": { "type": "string", "format": "color", "description": "Optional, derived from primary if omitted" },
          "accent": { "type": "string", "format": "color", "description": "Optional, derived from primary if omitted" },
          "neutral": { "type": "string", "format": "color", "description": "Optional, derived from primary if omitted" }
        }
      },
      "config": {
        "properties": {
          "saturation": { "type": "number", "minimum": -100, "maximum": 100 },
          "temperature": { "type": "number", "minimum": -100, "maximum": 100 },
          "contrastBoost": { "type": "number", "minimum": 0, "maximum": 100 }
        }
      },
      "accessibility": {
        "properties": {
          "level": { "enum": ["AA", "AAA"] }
        }
      },
      "typography": {
        "properties": {
          "fontSans": { "type": "string" },
          "fontMono": { "type": "string" },
          "fontSerif": { "type": "string" },
          "scale": { "type": "number" },
          "baseSize": { "type": "number" }
        }
      },
      "overrides": {
        "description": "Direct token overrides for specific modes",
        "properties": {
          "light": { "type": "object", "additionalProperties": { "type": "string" } },
          "dark": { "type": "object", "additionalProperties": { "type": "string" } }
        }
      }
    }
  }
}
